<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml"><meta charset="UTF-8"><link href="assets/css/source-ayu-light.css" rel="stylesheet" type="text/css"><script src="assets/js/highlight.js" type="text/javascript"></script><div id="package-header"><span class="caption"></span></div><pre id="src-content"><span class="ju-keyword">module</span> <span id="1100"><span class="annot"><a href="Anoma.Balance-src.html#1100"><span class="annot"><a href="Anoma.Balance-src.html#1100"><span class="ju-var">Anoma<span class="ju-delimiter">.</span>Balance</span></a></span></a></span></span><span class="ju-delimiter">;</span>

<span class="ju-keyword">import</span> <span class="annot"><a href="Anoma.Prelude-src.html#3"><span class="ju-var">Anoma<span class="ju-delimiter">.</span>Prelude</span></a></span> <span class="ju-keyword">open</span><span class="ju-delimiter">;</span>
<span class="ju-keyword">import</span> <span class="annot"><a href="Data.ByteString-src.html#716"><span class="ju-var">Data<span class="ju-delimiter">.</span>ByteString</span></a></span> <span class="ju-keyword">open</span><span class="ju-delimiter">;</span>
<span class="ju-keyword">import</span> <span class="annot"><a href="Anoma.Resource-src.html#2"><span class="ju-var">Anoma<span class="ju-delimiter">.</span>Resource</span></a></span> <span class="ju-keyword">open</span><span class="ju-delimiter">;</span>
<span class="ju-keyword">import</span> <span class="annot"><a href="Anoma.Kind-src.html#719"><span class="ju-var">Anoma<span class="ju-delimiter">.</span>Kind</span></a></span> <span class="ju-keyword">open</span><span class="ju-delimiter">;</span>

<span class="ju-keyword">import</span> <span class="annot"><a href="Data.Map-src.html#788"><span class="ju-var">Data<span class="ju-delimiter">.</span>Map</span></a></span> <span class="ju-keyword">as</span> <span id="788"><span class="annot"><a href="Data.Map-src.html#788"><span class="annot"><a href="Data.Map-src.html#788"><span class="ju-var">Map</span></a></span></a></span></span><span class="ju-delimiter">;</span>

<span class="ju-keyword">type</span> <span id="1101"><span class="annot"><a href="Anoma.Balance-src.html#1101"><span class="annot"><a href="Anoma.Balance-src.html#1101"><span class="ju-inductive">Balance</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span id="1102"><span class="annot"><a href="Anoma.Balance-src.html#1102"><span class="annot"><a href="Anoma.Balance-src.html#1102"><span class="ju-constructor">balance</span></a></span></a></span></span> <span class="ju-keyword">:</span> <span class="annot"><a href="Juvix.Builtin.V1.List-src.html#116"><span class="ju-inductive">List</span></a></span> <span class="annot"><a href="Anoma.Kind-src.html#721"><span class="ju-function"><span class="ju-delimiter">(</span>Kind</span></a></span> <span class="annot"><a href="Stdlib.Data.Product.Base-src.html#149"><span class="ju-inductive">Ã—</span></a></span> <span class="annot"><a href="Stdlib.Data.Int.Base-src.html#590"><span class="ju-inductive">Int</span></a></span><span class="ju-delimiter">)</span> <span class="ju-keyword">-&gt;</span> <span class="annot"><a href="Anoma.Balance-src.html#1101"><span class="ju-inductive">Balance</span></a></span><span class="ju-delimiter">;</span>
<span id="1104"><span class="annot"><a href="Anoma.Balance-src.html#1104"><span class="annot"><a href="Anoma.Balance-src.html#1104"><span class="ju-function">
emptyBalance</span></a></span></a></span></span> <span class="ju-keyword">:</span> <span class="annot"><a href="Anoma.Balance-src.html#1101"><span class="ju-inductive">Balance</span></a></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="Anoma.Balance-src.html#1102"><span class="ju-constructor">balance</span></a></span> <span class="annot"><a href="Juvix.Builtin.V1.List-src.html#117"><span class="ju-constructor">nil</span></a></span><span class="ju-delimiter">;</span>
<span id="1105"><span class="annot"><a href="Anoma.Balance-src.html#1105"><span class="annot"><a href="Anoma.Balance-src.html#1105"><span class="ju-function">
addBalance</span></a></span></a></span></span> <span class="ju-keyword">:</span> <span class="annot"><a href="Anoma.Balance-src.html#1101"><span class="ju-inductive">Balance</span></a></span> <span class="ju-keyword">-&gt;</span> <span class="annot"><a href="Anoma.Balance-src.html#1101"><span class="ju-inductive">Balance</span></a></span> <span class="ju-keyword">-&gt;</span> <span class="annot"><a href="Anoma.Balance-src.html#1101"><span class="ju-inductive">Balance</span></a></span>
  <span class="ju-keyword">|</span> <span class="annot"><a href="Anoma.Balance-src.html#1102"><span class="ju-constructor"><span class="ju-delimiter">(</span>balance</span></a></span> <span id="1110"><span class="annot"><a href="Anoma.Balance-src.html#1110"><span class="annot"><a href="Anoma.Balance-src.html#1110"><span class="ju-var">xs</span></a></span></a></span></span><span class="ju-delimiter">)</span> <span class="annot"><a href="Anoma.Balance-src.html#1102"><span class="ju-constructor"><span class="ju-delimiter">(</span>balance</span></a></span> <span id="1111"><span class="annot"><a href="Anoma.Balance-src.html#1111"><span class="annot"><a href="Anoma.Balance-src.html#1111"><span class="ju-var">ys</span></a></span></a></span></span><span class="ju-delimiter">)</span> <span class="ju-keyword">:=</span>
    <span class="annot"><a href="Anoma.Balance-src.html#1102"><span class="ju-constructor">balance</span></a></span> <span class="annot"><a href="Data.Map-src.html#1034"><span class="ju-function"><span class="ju-delimiter">(</span>Map<span class="ju-delimiter">.</span>toList</span></a></span> <span class="annot"><a href="Data.Map-src.html#1032"><span class="ju-function"><span class="ju-delimiter">(</span>Map<span class="ju-delimiter">.</span>fromListWith</span></a></span> <span class="annot"><a href="Juvix.Builtin.V1.Trait.Natural-src.html#459"><span class="ju-function"><span class="ju-delimiter">(</span>+</span></a></span><span class="ju-delimiter">)</span> <span class="annot"><a href="Anoma.Balance-src.html#1110"><span class="ju-var"><span class="ju-delimiter">(</span>xs</span></a></span> <span class="annot"><a href="Stdlib.Data.List.Base-src.html#278"><span class="ju-function">++</span></a></span> <span class="annot"><a href="Anoma.Balance-src.html#1111"><span class="ju-var">ys</span></a></span><span class="ju-delimiter">)</span><span class="ju-delimiter">)</span><span class="ju-delimiter">)</span><span class="ju-delimiter">;</span>
<span id="1106"><span class="annot"><a href="Anoma.Balance-src.html#1106"><span class="annot"><a href="Anoma.Balance-src.html#1106"><span class="ju-function">
negateBalance</span></a></span></a></span></span> <span class="ju-keyword">:</span> <span class="annot"><a href="Anoma.Balance-src.html#1101"><span class="ju-inductive">Balance</span></a></span> <span class="ju-keyword">-&gt;</span> <span class="annot"><a href="Anoma.Balance-src.html#1101"><span class="ju-inductive">Balance</span></a></span>
  <span class="ju-keyword">|</span> <span class="annot"><a href="Anoma.Balance-src.html#1102"><span class="ju-constructor"><span class="ju-delimiter">(</span>balance</span></a></span> <span id="1112"><span class="annot"><a href="Anoma.Balance-src.html#1112"><span class="annot"><a href="Anoma.Balance-src.html#1112"><span class="ju-var">bs</span></a></span></a></span></span><span class="ju-delimiter">)</span> <span class="ju-keyword">:=</span> <span class="annot"><a href="Anoma.Balance-src.html#1102"><span class="ju-constructor">balance</span></a></span> <span class="annot"><a href="Stdlib.Data.List.Base-src.html#268"><span class="ju-function"><span class="ju-delimiter">(</span>map</span></a></span> <span id="1113"><span class="annot"><a href="Anoma.Balance-src.html#1113"><span class="annot"><a href="Anoma.Balance-src.html#1113"><span class="ju-var"><span class="ju-delimiter">(</span>b</span></a></span></a></span></span> <span class="ju-keyword">in</span> <span class="annot"><a href="Anoma.Balance-src.html#1112"><span class="ju-var">bs</span></a></span><span class="ju-delimiter">)</span> <span class="annot"><a href="Stdlib.Data.Product.Base-src.html#158"><span class="ju-function">second</span></a></span> <span class="annot"><a href="Stdlib.Data.Int.Base-src.html#599"><span class="ju-function">neg</span></a></span> <span class="annot"><a href="Anoma.Balance-src.html#1113"><span class="ju-var">b</span></a></span><span class="ju-delimiter">)</span><span class="ju-delimiter">;</span>
<span id="1107"><span class="annot"><a href="Anoma.Balance-src.html#1107"><span class="annot"><a href="Anoma.Balance-src.html#1107"><span class="ju-function">
subBalance</span></a></span></a></span></span> <span class="ju-delimiter">(</span><span class="annot"><a href="Anoma.Balance-src.html#1114"><span class="ju-var">b1</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="Anoma.Balance-src.html#1101"><span class="ju-inductive">Balance</span></a></span><span class="ju-delimiter">)</span> <span class="ju-delimiter">(</span><span class="annot"><a href="Anoma.Balance-src.html#1115"><span class="ju-var">b2</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="Anoma.Balance-src.html#1101"><span class="ju-inductive">Balance</span></a></span><span class="ju-delimiter">)</span> <span class="ju-keyword">:</span> <span class="annot"><a href="Anoma.Balance-src.html#1101"><span class="ju-inductive">Balance</span></a></span> <span class="ju-keyword">:=</span>
  <span class="annot"><a href="Anoma.Balance-src.html#1105"><span class="ju-function">addBalance</span></a></span> <span class="annot"><a href="Anoma.Balance-src.html#1114"><span class="ju-var">b1</span></a></span> <span class="annot"><a href="Anoma.Balance-src.html#1106"><span class="ju-function"><span class="ju-delimiter">(</span>negateBalance</span></a></span> <span class="annot"><a href="Anoma.Balance-src.html#1115"><span class="ju-var">b2</span></a></span><span class="ju-delimiter">)</span><span class="ju-delimiter">;</span>
<span id="1108"><span class="annot"><a href="Anoma.Balance-src.html#1108"><span class="annot"><a href="Anoma.Balance-src.html#1108"><span class="ju-function">
sumBalances</span></a></span></a></span></span> <span class="ju-delimiter">(</span><span class="annot"><a href="Anoma.Balance-src.html#1116"><span class="ju-var">bs</span></a></span> <span class="ju-keyword">:</span> <span class="annot"><a href="Juvix.Builtin.V1.List-src.html#116"><span class="ju-inductive">List</span></a></span> <span class="annot"><a href="Anoma.Balance-src.html#1101"><span class="ju-inductive">Balance</span></a></span><span class="ju-delimiter">)</span> <span class="ju-keyword">:</span> <span class="annot"><a href="Anoma.Balance-src.html#1101"><span class="ju-inductive">Balance</span></a></span> <span class="ju-keyword">:=</span>
  <span class="annot"><a href="Stdlib.Data.List.Base-src.html#267"><span class="ju-function">for</span></a></span> <span id="1117"><span class="annot"><a href="Anoma.Balance-src.html#1117"><span class="annot"><a href="Anoma.Balance-src.html#1117"><span class="ju-var"><span class="ju-delimiter">(</span>acc</span></a></span></a></span></span> <span class="ju-keyword">:=</span> <span class="annot"><a href="Anoma.Balance-src.html#1104"><span class="ju-function">emptyBalance</span></a></span><span class="ju-delimiter">)</span> <span id="1118"><span class="annot"><a href="Anoma.Balance-src.html#1118"><span class="annot"><a href="Anoma.Balance-src.html#1118"><span class="ju-var"><span class="ju-delimiter">(</span>b</span></a></span></a></span></span> <span class="ju-keyword">in</span> <span class="annot"><a href="Anoma.Balance-src.html#1116"><span class="ju-var">bs</span></a></span><span class="ju-delimiter">)</span>
    <span class="annot"><a href="Anoma.Balance-src.html#1105"><span class="ju-function">addBalance</span></a></span> <span class="annot"><a href="Anoma.Balance-src.html#1117"><span class="ju-var">acc</span></a></span> <span class="annot"><a href="Anoma.Balance-src.html#1118"><span class="ju-var">b</span></a></span><span class="ju-delimiter">;</span>
<span id="1109"><span class="annot"><a href="Anoma.Balance-src.html#1109"><span class="annot"><a href="Anoma.Balance-src.html#1109"><span class="ju-function">
balanceIsZero</span></a></span></a></span></span> <span class="ju-keyword">:</span> <span class="annot"><a href="Anoma.Balance-src.html#1101"><span class="ju-inductive">Balance</span></a></span> <span class="ju-keyword">-&gt;</span> <span class="annot"><a href="Juvix.Builtin.V1.Bool-src.html#7"><span class="ju-inductive">Bool</span></a></span>
  <span class="ju-keyword">|</span> <span class="annot"><a href="Anoma.Balance-src.html#1102"><span class="ju-constructor"><span class="ju-delimiter">(</span>balance</span></a></span> <span id="1119"><span class="annot"><a href="Anoma.Balance-src.html#1119"><span class="annot"><a href="Anoma.Balance-src.html#1119"><span class="ju-var">bs</span></a></span></a></span></span><span class="ju-delimiter">)</span> <span class="ju-keyword">:=</span> <span class="annot"><a href="Stdlib.Data.List.Base-src.html#286"><span class="ju-function">all</span></a></span> <span id="1120"><span class="annot"><a href="Anoma.Balance-src.html#1120"><span class="annot"><a href="Anoma.Balance-src.html#1120"><span class="ju-var"><span class="ju-delimiter">(</span>b</span></a></span></a></span></span> <span class="ju-keyword">in</span> <span class="annot"><a href="Anoma.Balance-src.html#1119"><span class="ju-var">bs</span></a></span><span class="ju-delimiter">)</span> <span class="annot"><a href="Stdlib.Data.Product.Base-src.html#155"><span class="ju-function">snd</span></a></span> <span class="annot"><a href="Anoma.Balance-src.html#1120"><span class="ju-var">b</span></a></span> <span class="annot"><a href="Stdlib.Trait.Eq-src.html#59"><span class="ju-function">==</span></a></span> <span class="ju-number">0</span><span class="ju-delimiter">;</span>
</pre><footer><pre>Powered by <a href="https://juvix.org">Juvix </a><a href="https://github.com/anoma/juvix/commit/69594ed">0.5.5-69594ed</a></pre></footer><span>Last modified on 2023-12-07 10:36 UTC</span></html>